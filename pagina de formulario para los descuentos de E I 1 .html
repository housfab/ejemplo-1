<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Registro Moderno</title>
    <style>
        /* Estilos Generales y Reset */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
        }

        /* Contenedor del Formulario */
        .form-container {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
        }

        h2 {
            text-align: center;
            color: #3f51b5;
            margin-bottom: 30px;
        }

        /* Estilo para cada grupo de campo */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input {
            width: calc(100% - 20px); /* Ajuste para padding */
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3f51b5;
            box-shadow: 0 0 0 3px rgba(63, 81, 181, 0.2);
        }

        /* Estilos de validación */
        .form-group input.invalid {
            border-color: #e53935; /* Rojo */
        }

        .form-group input.valid {
            border-color: #43a047; /* Verde */
        }

        .error-message {
            color: #e53935; /* Rojo */
            font-size: 0.85em;
            margin-top: 5px;
            display: none; /* Oculto por defecto */
        }

        /* Botón de Enviar */
        button[type="submit"] {
            width: 100%;
            padding: 12px;
            background-color: #3f51b5;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 20px;
        }

        button[type="submit"]:hover {
            background-color: #303f9f;
        }

        /* Mensaje de éxito */
        #mensaje-exito {
            text-align: center;
            color: #43a047; /* Verde */
            font-weight: bold;
            margin-top: 20px;
            display: none; /* Oculto por defecto */
        }
    </style>
</head>
<body>
    <div class="form-container">
        <h2>Registro de Usuario</h2>
        <form id="registroForm" novalidate>
            <div class="form-group">
                <label for="nombre">Nombre Completo:</label>
                <input type="text" id="nombre" name="nombre" required minlength="2">
                <span class="error-message" aria-live="polite"></span>
            </div>

            <div class="form-group">
                <label for="usuario">Nombre de Usuario:</label>
                <input type="text" id="usuario" name="usuario" required pattern="^[a-zA-Z0-9]{4,15}$" title="Solo letras y números, 4 a 15 caracteres.">
                <span class="error-message" aria-live="polite"></span>
            </div>

            <div class="form-group">
                <label for="documento">Documento (DNI/Cédula):</label>
                <input type="text" id="documento" name="documento" required pattern="^\d{6,10}$" title="Solo números, 6 a 10 dígitos.">
                <span class="error-message" aria-live="polite"></span>
            </div>
            <div class="form-group">
                <label for="telefono">Teléfono:</label>
                <input type="tel" id="telefono" name="telefono" required pattern="^\+?\d{6,15}$" title="Solo números y el signo '+' opcional, 6 a 15 dígitos.">
                <span class="error-message" aria-live="polite"></span>
            </div>
            
            <div class="form-group">
                <label for="correo">Correo Electrónico:</label>
                <input type="email" id="correo" name="correo" required>
                <span class="error-message" aria-live="polite"></span>
            </div>

            <div class="form-group">
                <label for="password">Contraseña:</label>
                <input type="password" id="password" name="password" required pattern=".{8,}" title="Debe contener al menos 8 caracteres.">
                <span class="error-message" aria-live="polite"></span>
            </div>

            <button type="submit">Registrarse</button>
            <p id="mensaje-exito">¡Formulario enviado con éxito!</p>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('registroForm');
            const inputs = form.querySelectorAll('input');
            const mensajeExito = document.getElementById('mensaje-exito');

            // Función para mostrar u ocultar el mensaje de error y aplicar clases CSS
            function validarCampo(input) {
                const errorMessageSpan = input.nextElementSibling; // El span de error justo después del input

                if (input.validity.valid) {
                    // Si el campo es válido
                    errorMessageSpan.textContent = '';
                    errorMessageSpan.style.display = 'none';
                    input.classList.remove('invalid');
                    input.classList.add('valid');
                } else {
                    // Si el campo es inválido
                    errorMessageSpan.style.display = 'block';
                    input.classList.remove('valid');
                    input.classList.add('invalid');

                    if (input.validity.valueMissing) {
                        errorMessageSpan.textContent = 'Este campo es obligatorio.';
                    } else if (input.validity.typeMismatch) {
                        if (input.type === 'email') {
                            errorMessageSpan.textContent = 'Por favor, ingrese una dirección de correo válida.';
                        } else {
                            errorMessageSpan.textContent = 'El valor ingresado no es del tipo correcto.';
                        }

                    } else if  (input.type === 'tel') { 
                        errorMessageSpan.textContent = input.title || 'El formato no es válido.';
                    } else if (input.validity.tooShort) {
                        errorMessageSpan.textContent = `Mínimo ${input.minLength} caracteres.`;
                    } else {
                        errorMessageSpan.textContent = 'El valor ingresado es inválido.';
                    }
                }
            }

            // Añadir escuchadores de eventos a cada input para validación en tiempo real
            inputs.forEach(input => {
                input.addEventListener('input', () => {
                    validarCampo(input);
                });
                // También validamos cuando el usuario sale del campo (blur)
                input.addEventListener('blur', () => {
                    validarCampo(input);
                });
            });

            // Manejar el evento de envío del formulario
            form.addEventListener('submit', (event) => {
                event.preventDefault(); // Evitar el envío por defecto del navegador

                let formValido = true;

                // Iterar sobre todos los inputs para validar y mostrar errores antes del envío
                inputs.forEach(input => {
                    validarCampo(input); // Forzar la validación y mostrar errores
                    if (!input.validity.valid) {
                        formValido = false;
                    }
                });

                if (formValido) {
                    // Si el formulario es completamente válido
                    console.log('Formulario enviado con éxito:', {
                        nombre: document.getElementById('nombre').value,
                        usuario: document.getElementById('usuario').value,
                        documento: document.getElementById('documento').value,
                        telefono: document.getElementById('telefono').value,
                        correo: document.getElementById('correo').value,
                        password: '***' // No mostrar la contraseña real en consola
                    });

                    // Aquí iría la lógica para enviar los datos al servidor (por ejemplo, con fetch API)
                    // fetch('/api/register', {
                    //     method: 'POST',
                    //     headers: { 'Content-Type': 'application/json' },
                    //     body: JSON.stringify({
                    //         nombre: document.getElementById('nombre').value,
                    //         usuario: document.getElementById('usuario').value,
                    //         documento: document.getElementById('documento').value,
                    //         correo: document.getElementById('correo').value,
                    //         password: document.getElementById('password').value
                    //     })
                    // })
                    // .then(response => response.json())
                    // .then(data => {
                    //     console.log('Success:', data);
                    //     form.reset();
                    //     inputs.forEach(input => input.classList.remove('valid')); // Limpiar estilos
                    //     mensajeExito.style.display = 'block';
                    //     setTimeout(() => { mensajeExito.style.display = 'none'; }, 3000);
                    // })
                    // .catch((error) => {
                    //     console.error('Error:', error);
                    //     // Mostrar un mensaje de error global
                    // });

                    // Por ahora, solo mostramos el mensaje de éxito
                    form.reset(); // Limpiar el formulario
                    inputs.forEach(input => { // Quitar las clases valid/invalid después de resetear
                        input.classList.remove('valid');
                        input.classList.remove('invalid');
                    });
                    mensajeExito.style.display = 'block';
                    setTimeout(() => {
                        mensajeExito.style.display = 'none';
                    }, 3000); // Ocultar el mensaje de éxito después de 3 segundos
                } else {
                    console.log('Formulario con errores, por favor revise los campos.');
                }
            });
        });
    </script>
</body>
</html>